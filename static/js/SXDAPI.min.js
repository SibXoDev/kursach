"use strict";const SXDAPI=new class{#isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent);#setAttributes=["textContent","innerHTML","value","src"];#svgAttr=["svg","g","path","d"];#url="";#serverStatus=!1;#networkStatus=!1;#connectStatus=0;#serverStatusChangeList=[];#networkStatusChangeList=[];#connectStatusChangeList=[];#activeConnections=[];#lastConnectValue={};set onchangeserverstatus(t){-1==this.#serverStatusChangeList.indexOf(t)&&this.#serverStatusChangeList.push(t)}set onchangenetworkstatus(t){-1==this.#networkStatusChangeList.indexOf(t)&&this.#networkStatusChangeList.push(t)}set onchangeconnectstatus(t){-1==this.#connectStatusChangeList.indexOf(t)&&this.#connectStatusChangeList.push(t)}set url(t){this.#url=t,this.connect(this.url,"",{mode:"no-cors"},()=>{console.log("[SXDAPI] Server connect:",this.#serverStatus)},t=>{console.log("[SXDAPI] Server connect:",this.#serverStatus)},!0)}get isMobile(){return this.#isMobile}get url(){return this.#url}get serverStatus(){return this.#serverStatus}get networkStatus(){return this.#networkStatus}get connectStatus(){return this.#connectStatus}get lastConnectValue(){return this.#lastConnectValue}constructor(){"onLine"in navigator?(this.#networkStatus=navigator.onLine,console.log("[SXDAPI] Network connect:",this.#networkStatus)):this.connect("https://yandex.ru/","",{mode:"no-cors"},()=>{console.log("[SXDAPI] Network connect:",this.#networkStatus)},t=>{console.log("[SXDAPI] Network connect:",this.#networkStatus)},!0),window.addEventListener("online",()=>this.#changeNetworkStatus(!0)),window.addEventListener("offline",()=>this.#changeNetworkStatus(!1)),this.#checkServer(),window.addEventListener("load",()=>{document.body.classList.remove("load")})}getCSS(t,e){return window.getComputedStyle(t,null).getPropertyValue(e)||null}createDOM(s={},t="div",e=document.body,o="",n=!0){let i;return-1==this.#svgAttr.indexOf(t)?i=document.createElement(t):(i=document.createElementNS("http://www.w3.org/2000/svg",t),"svg"==t&&(i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"))),Object.keys(s).forEach(e=>{"style"==e?"object"==typeof s[e]?Object.keys(s[e]).forEach(t=>{i.style[t]=s[e][t]}):i.style=s[e]:-1==this.#setAttributes.indexOf(e)&&e.indexOf("on")?i.setAttribute(e,s[e]):i[e]=s[e]}),n&&(o?e.insertAdjacentElement(o,i):e.appendChild(i)),i}getOffset(t){t=t.getBoundingClientRect();return{x:t.left+window.scrollX,y:t.top+window.scrollY}}async connect(t=this.url,s="",e={},o=()=>{},n=t=>{},i=!1){!(this.#networkStatus&&this.#serverStatus||i)||-1!=this.#activeConnections.indexOf(s)&&!i||(i||this.#activeConnections.push(s),e={method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json",Accept:"application/json"},...e},await fetch(""+t+s,e).then(t=>{var e=this.#activeConnections.indexOf(s);return-1!=e&&this.#activeConnections.splice(e,1),this.#changeConnectStatus(t.status),t.ok?t.clone().json():{status:t.status}}).then(t=>{let e=!1;e=!("status"in t)||!(500<=t.status||300<=t.status&&t.status<400),this.#changeNetworkStatus(!0),this.#changeServerStatus(e),this.#lastConnectValue={},e&&(this.#lastConnectValue=t,o(t))}).catch(t=>{var e=this.#activeConnections.indexOf(s);-1!=e&&this.#activeConnections.splice(e,1),this.#lastConnectValue={},this.#changeNetworkStatus(!1),this.#changeServerStatus(!1),n(t)}))}#changeServerStatus(e){this.#serverStatus!=e&&"boolean"==typeof e&&(this.#serverStatus=e,this.#serverStatusChangeList.forEach(t=>t(e)))}#changeNetworkStatus(e){this.#networkStatus!=e&&"boolean"==typeof e&&(this.#networkStatus=e,this.#networkStatusChangeList.forEach(t=>t(e)))}#changeConnectStatus(e){this.#connectStatus!=e&&"number"==typeof e&&(this.#connectStatus=e,this.#connectStatusChangeList.forEach(t=>t(e)))}#checkServer(){if(this.#url){const e=this.#url;this.connect(e,"",{},()=>this.#printServerStatus(e),t=>this.#printServerStatus(e),!0)}}#printServerStatus(t=this.#url){console.group("SXDAPI"),console.log("url:",t),console.log("Server connect:",this.#serverStatus),console.log("Connect status:",this.#connectStatus),console.groupEnd()}isElement(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}};SXDAPI.mouse=new class{event=new MouseEvent("");get position(){return{x:this.event.clientX,y:this.event.clientY}}constructor(){window.addEventListener("mousemove",t=>this._update(t)),window.addEventListener("mousedown",t=>this._update(t)),window.addEventListener("wheel",t=>this._update(t))}_update(t){this.event=t}},SXDAPI.contextMenu=new class{#timer;browserContextMenu=!0;defaultContextMenu=!1;autoShow=!0;showFooter=!1;contextMenu;castomButtons=[];transition=200;showOnMouseUp=!1;#castomButtons=[];style={main:"sxd-context-menu",footer:"sxd-context-menu__footer",hideMain:"sxd-context-menu--hide"};allowInsert=["input","textarea"];get visible(){return-1==this.contextMenu.className.indexOf(this.style.hideMain)}constructor(){window.oncontextmenu=t=>t.ctrlKey&&this.browserContextMenu||this.defaultContextMenu,window.addEventListener("load",()=>{this.browserContextMenu&&(console.group("SibXoDevAPI"),console.log("Чтобы открыть контекстное меню браузера используйте: CTRL + RIGHT MOUSE"),console.groupEnd()),this.contextMenu=SXDAPI.createDOM({class:[this.style.main,this.style.hideMain].join(" ")}),this.transition=1e3*+SXDAPI.getCSS(this.contextMenu,"transition").split(" ")[1].replace(/[a-z]/gm,""),this.btCopy=SXDAPI.createDOM({textContent:"Скопировать",onclick:()=>{var t=window.getSelection().toString();t&&navigator.clipboard.writeText(t).then(()=>{SXDAPI.description.show({text:"Скопировано",color:"#15ff00",time:1500})}).catch(t=>{console.error("[SXDAPI] Ошибка при копировании: ",t)}),this.hide()}},"button",this.contextMenu),SXDAPI.createDOM({textContent:"CTRL + C"},"span",this.btCopy),this.btPaste=SXDAPI.createDOM({textContent:"Вставить",onclick:()=>{navigator.clipboard.readText().then(t=>{this.activeElement&&(this.activeElement.focus(),console.log(t))}).catch(t=>{console.error("[SXDAPI] Ошибка при вставке: ",t)}),this.hide()}},"button",this.contextMenu),SXDAPI.createDOM({textContent:"CTRL + V"},"span",this.btPaste),navigator.permissions.query({name:"clipboard-write"}).then(t=>{console.log("[SXDAPI][permissions] clipboard-write: "+("granted"==t.state||"prompt"==t.state))}),navigator.permissions.query({name:"clipboard-read"}).then(t=>{console.log("[SXDAPI][permissions] clipboard-read: "+("granted"==t.state||"prompt"==t.state))}),this.#checkClipboardPermissions(),this.footer=SXDAPI.createDOM({class:this.style.footer,textContent:"Чтобы открыть контекстное меню браузера используйте: CTRL + RIGHT MOUSE"},"div",this.contextMenu),window.addEventListener("mousedown",t=>{this.defaultContextMenu||-1==t.composedPath().indexOf(this.contextMenu)&&this.hide()}),window.addEventListener("wheel",t=>{this.defaultContextMenu||-1==t.composedPath().indexOf(this.contextMenu)&&this.hide()}),window.addEventListener("mouseup",t=>{this.defaultContextMenu||(t.ctrlKey&&this.browserContextMenu||!this.autoShow&&!this.showOnMouseUp||2!==t.button||this.visible?-1==t.composedPath().indexOf(this.contextMenu)&&this.hide():this.show()),this.showOnMouseUp=!1})})}show(t=!1){var e;(!t||SXDAPI.mouse.event.ctrlKey&&this.browserContextMenu||!this.autoShow||2!==SXDAPI.mouse.event.button||this.visible)&&(this.activeElement=null,this.footer.style.display=this.showFooter?"":"none",this.showOnMouseUp=!1,this.clearCastomButtons(),this.#checkClipboardPermissions(),SXDAPI.mouse.event&&(this.activeElement=SXDAPI.mouse.event.composedPath()[0],SXDAPI.mouse.event.composedPath().length&&(-1!=this.allowInsert.indexOf(SXDAPI.mouse.event.composedPath()[0].tagName.toLowerCase())?this.btPaste.style.display="":this.btPaste.style.display="none")),this.castomButtons.length&&this.castomButtons.forEach(t=>{var e;"object"==typeof t&&t.onclick&&t.text&&(e=SXDAPI.createDOM({textContent:t.text,onclick:t.onclick},"button",this.contextMenu),t.description&&SXDAPI.createDOM({textContent:t.description},"span",e),this.#castomButtons.push(e))}),t=SXDAPI.mouse.position.x+this.contextMenu.offsetWidth,e=SXDAPI.mouse.position.y+this.contextMenu.offsetHeight,this.contextMenu.style.left=(t>window.innerWidth?window.innerWidth-this.contextMenu.offsetWidth:SXDAPI.mouse.position.x)+"px",this.contextMenu.style.top=(e>window.innerHeight?window.innerHeight-this.contextMenu.offsetHeight:SXDAPI.mouse.position.y)+"px",this.contextMenu.classList.remove(this.style.hideMain),clearTimeout(this.#timer),this.contextMenu.onmouseover=t=>{clearTimeout(this.#timer),this.#timer=setTimeout(()=>{this.contextMenu.onmouseleave()},5e3)},this.contextMenu.onmouseleave=t=>{clearTimeout(this.#timer),this.#timer=setTimeout(()=>{this.hide()},5e3)},this.contextMenu.onmouseleave())}hide(){this.castomButtons=[],this.activeElement=null,clearTimeout(this.#timer),this.contextMenu.classList.add(this.style.hideMain),this.#timer=setTimeout(()=>this.clearCastomButtons(),this.transition)}clearCastomButtons(){clearTimeout(this.#timer),this.#castomButtons.forEach(t=>t.remove()),this.#castomButtons=[]}#checkClipboardPermissions(){navigator.permissions.query({name:"clipboard-write"}).then(t=>{this.btCopy.disabled=!("granted"==t.state||"prompt"==t.state)}),navigator.permissions.query({name:"clipboard-read"}).then(t=>{this.btPaste.disabled=!("granted"==t.state||"prompt"==t.state)})}},SXDAPI.description=new class{#queue=[];#isTime=!0;#isLoad=!1;#timer;#isInit=!1;constructor(){window.addEventListener("load",()=>{this.container=SXDAPI.createDOM({class:"sxd-description",onmousedown:t=>{t.target==this.container&&1==t.which&&this.hide()}}),this.text=SXDAPI.createDOM({class:"sxd-description-text"},"div",this.container),this.#isInit=!0,this.#queue.length&&this.show(this.#queue.shift(),!1)})}hide(){this.#isInit&&(this.container.style.borderColor="transparent",this.container.classList.remove("sxd-description-show"),this.isShow=!1,clearTimeout(this.#timer),this.#timer=setTimeout(()=>{this.isShow=!1,this.#queue.length&&this.show(this.#queue.shift(),!1)},500))}show(t={},e=!0){this.#isInit?(e&&this.#queue.length&&(this.isShow||this.#checkQueue(t)?this.update(t):this.#queue.push(t)),this.isShow=!0,this.#isTime=t.isTime,t.time=t.time||3e3,this.time=t.time,this.update(t)):this.#checkQueue(t)||this.#queue.push(t)}update(t={}){this.#isInit&&(this.#isTime=t.isTime||!0,this.#isLoad=t.isLoad||!1,this.container.style.borderColor=t.color||"#fff",this.container.style.background=t.background||"#1d1e22",this.text.textContent=t.text||"",t.textHTML&&(this.text.innerHTML=t.textHTML),this.container.classList.add("sxd-description-show"),this.container.classList.remove("sxd-description-load"),this.#startAnim())}#startAnim(t=this.time){this.isShow&&this.#isTime&&(this.time=t,this.startTime=performance.now(),this.endTime=0,this.#isLoad&&this.container.classList.add("sxd-description-load"),clearTimeout(this.#timer),this.#timer=setTimeout(()=>{this.hide()},t))}#checkQueue(e={}){return!(!e||!this.#queue.length)&&this.#queue.some(t=>t.text===e.text)}},SXDAPI.dropdownMenu=new class{constructor(){window.addEventListener("load",()=>{document.querySelectorAll(".dropdown-menu").forEach(t=>{let s=t.querySelector(".dropdown-menu__preview"),o=t.querySelectorAll(".dropdown-menu__item");s.textContent=s.getAttribute("placeholder"),s.classList.add("dropdown-menu__preview--not-selected"),s.onmousedown=function(t){0===t.button&&this.classList.toggle("dropdown-menu__preview--active")},s.onfocus=function(){this.classList.add("dropdown-menu__preview--active")},s.onblur=function(){this.classList.remove("dropdown-menu__preview--active")},o.forEach(e=>{e.onmousedown=t=>this.mouseDownItem(t,e,o,s)})})})}create(t,e="",s=[],o={}){o={dropdownMenu:[],preview:[],...o};t=createUI({class:"dropdown-menu "+o.dropdownMenu.join(" ")},"div",t);let n=createUI({class:"dropdown-menu__preview "+o.preview.join(" "),textContent:e},"button",t),i=[],r=createUI({class:"dropdown-menu__list"},"div",t);return n.classList.add("dropdown-menu__preview--not-selected"),n.onmousedown=function(t){0===t.button&&this.classList.toggle("dropdown-menu__preview--active")},n.onfocus=function(){this.classList.add("dropdown-menu__preview--active")},n.onblur=function(){this.classList.remove("dropdown-menu__preview--active")},s.forEach(t=>{let e=createUI({class:"dropdown-menu__item",textContent:t,onmousedown:t=>this.mouseDownItem(t,e,i,n)},"div",r);i.push(e)}),t}activeItem(t,e,s){s.classList.remove("input-error"),t.forEach(t=>t.classList.remove("dropdown-menu__item--active")),e.classList.add("dropdown-menu__item--active"),s.classList.add("dropdown-menu__preview--ready"),s.classList.remove("dropdown-menu__preview--not-selected"),s.textContent=e.textContent}update(t,e){let s=t.querySelector(".dropdown-menu__preview"),o=[],n=t.querySelector(".dropdown-menu__list");n.textContent="",e.forEach(t=>{let e=createUI({style:{textTransform:"none"},class:"dropdown-menu__item",textContent:t,onmousedown:t=>this.mouseDownItem(t,e,o,s)},"div",n);o.push(e)})}mouseDownItem(t,e,s,o){0===t.button&&this.activeItem(s,e,o)}},SXDAPI.websocket=new class{#socket=null;url="";set onmessage(e){this.#socket&&(this.#socket.onmessage=t=>{console.log(t.data),e&&e(t)})}constructor(){console.log("[SXDAPI][WebSocket] ready")}connect(e=this.url,t="wss",s=[]){if(e){const o=t+"://"+e;this.#socket=new WebSocket(o,s),this.#socket.onopen=t=>{console.log("[SXDAPI][WebSocket] Соединение открыто")},this.#socket.onmessage=t=>{console.log(t.data),this.onmessage&&this.onmessage(t)},this.#socket.onclose=t=>{t.wasClean?(console.log(`[SXDAPI][WebSocket] Соединение закрыто, код=${t.code} причина=`+t.reason),this.#socket=null):console.log("[SXDAPI][WebSocket] Соединение прервано")},this.#socket.onerror=t=>{console.log("[SXDAPI][WebSocket][error] "+t.message),-1!=o.indexOf("wss")&&this.connect(e,"ws",s)}}}send(t){this.#socket.send(t)}close(t=1e3,e="SXDAPI"){this.#socket.close(t,e)}};